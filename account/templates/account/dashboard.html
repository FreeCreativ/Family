{% extends 'base.html' %}
{% load crispy_forms_filters %}
{% load crispy_forms_tags %}


{% block title %}
    - Dashboard
{% endblock %}

{% block content %}
    <div class="container p-0 mt-2">
        <div class="row">
            <div class="col-md-2 px-0">
                {% include "account/sidebar.html" %}
            </div>
            <div class="col-md-8 border border-1 px-1">
                <h3 class="h3 font-weight-bold text-bg-primary px-2 rounded-2 text-md-center">Profile</h3>
                <div class="container mb-2">
                    <div class="row row-cols-md-2">
                        <div class="col-md-3">
                            {% if user.profile_image %}
                                <img src="{{ user.profile_image.url }}" alt="profile picture"
                                     class="img-fluid">
                            {% else %}
                                <div class="dropdown">
                                    <button class="btn btn-secondary dropdown-toggle" type="button"
                                            id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                                        click to add image
                                    </button>
                                    <form class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                                        {% csrf_token %}
                                        {{ imageform.as_p }}
                                        <input type="submit" value="Upload">
                                    </form>
                                </div>
                                <a href="{% url 'account:p-update' user.username %}" class="link text-center d-block">click
                                    to add
                                    image</a>
                            {% endif %}
                        </div>
                        <div class="col-md-9 border border-1">
                            <ul class="list-group">
                                <li class="list-group-item"><span
                                        class="fw-semibold">Name:</span> {{ user.last_name }} {{ user.first_name }} {{ user.middle_name }}
                                </li>
                                <li class="list-group-item"><span
                                        class="fw-semibold">Username:</span> {{ user.username }}</li>
                                <li class="list-group-item"><span class="fw-semibold">Email:</span> {{ user.email }}
                                </li>
                                <li class="list-group-item"><span class="fw-semibold">Gender:</span> {{ user.gender }}
                                </li>
                                <li class="list-group-item"><span
                                        class="fw-semibold">Date of birth:</span> {{ user.date_of_birth }}</li>
                                <li class="list-group-item"><span class="fw-semibold">Age:</span> {{ user.age }}</li>
                                <li class="list-group-item"><span
                                        class="fw-semibold">Father:</span> {{ user.get_father }}</li>
                                <li class="list-group-item"><span
                                        class="fw-semibold">Mother:</span> {{ user.get_mother }}</li>
                                <p class="list-group-item"><span class="fw-semibold">Genealogy:</span>
                                    {% for u in user.genealogy %} |
                                        <a href="{% url 'account:dashboard' u %}">{{ u }}</a> |{% endfor %}
                                </p>

                                <li class="list-group-item"><span class="fw-semibold">Children:</span>
                                    {% for chil in user.children %}
                                        <a href="{% url 'account:dashboard' chil %}">{{ chil }}</a> ,{% endfor %}
                                </li>

                                <li class="list-group-item">{{ user.height }}</li>
                                <li class="list-group-item">{{ user.blood_group }}</li>
                                <li class="list-group-item">{{ user.genotype }}</li>
                                {% if not user.alive %}
                                    <li class="list-group-item">{{ user.date_of_death }}</li>
                                    <li class="list-group-item">{{ user.cause_of_death }}</li>
                                {% endif %}
                                {% if not user %}
                                    <a href="{% url 'account:r_continue' %}">Click Here! to add profile data</a>
                                {% endif %}
                            </ul>

                        </div>
                    </div>
                </div>
                <div class="container p-0">
                    <h4 class="h4 text-center">Biography</h4>
                    <p class="fw-bold fw-100">{{ user.biography }}</p>
                    {% if user.biography %}
                        <a href="">edit biography</a>
                    {% else %}
                        <a href="">add biography</a>

                    {% endif %}
                </div>

                <div>
                    <h4>Additional emails</h4>
                    {% for email in emails %}
                        <ul>
                            <li>{{ email.email }}</li>
                        </ul>
                    {% endfor %}
                    <h4>Phones</h4>
                    {% for number in phone_record %}
                        <ul>
                            <li>{{ number.phone_number }}</li>
                        </ul>
                    {% endfor %}
                </div>

                <div>
                    <h4>Education</h4>
                    <table>
                        <thead>
                        <th>Name of School</th>
                        <th>Duration</th>
                        <th>Year of entrance - year of graduation</th>
                        </thead>
                        <tbody>
                        {% for school in education %}
                            <tr>
                                <td>{{ school.name_of_school }}</td>
                                <td>{{ school.duration }}</td>
                                <td>{{ school.year_of_entrance }} - {{ school.year_of_graduation }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    <li><a href="{% url 'account:education_list' user.username %}">View all</a></li>
                </div>

                <div>
                    <h4>Hereditary Diseases</h4>
                    <table>
                        <thead>
                        <th>Disease</th>
                        <th>date of infection</th>
                        <th>type</th>
                        </thead>
                        <tbody>
                        {% for disease in diseases %}
                            <tr>
                                <td>{{ disease.disease_name }}</td>
                                <td>{{ disease.date_of_infection }}</td>
                                <td>{{ disease.type }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
                <h1>OST SECTION</h1>
                {% for post in post_list %}
                    <a href="{% url 'blog:detail' slug=post.slug %}">
                        <h1>{{ post.headline }}</h1>
                    </a>
                    <p>
                        {{ post.content }}
                        <li>
                            {% for comment in post.comment_set.all %}
                                <li>{{ comment }}</li>
                            {% endfor %}
                    </li>
                    </p>
                {% empty %}
                    No posts available
                {% endfor %}
            </div>
            <div class="col-md-2 visible-md px-0">
                {% include "sidebar.html" %}
            </div>
        </div>
    </div>
    {% include "footer.html" %}
{% endblock %}

