{% extends 'base.html' %}
{% load crispy_forms_filters %}
{% load crispy_forms_tags %}


{% block title %}
    - Dashboard
{% endblock %}

{% block content %}
    <div class="container p-0 mt-2">
        <div class="row">
            <div class="col-md-2 px-0">
                {% include "account/sidebar.html" %}
            </div>
            <div class="col-md-8 border border-1 px-1">
                <div class="container mb-2">
                    <div class="row row-cols-md-2">
                        <div class="col-md-3">
                            {% if user.profile_image %}
                                <img src="{{ user.profile_image.url }}" alt="profile picture"
                                     class="img-fluid">
                            {% else %}
                                <div class="dropdown">
                                    <button class="btn btn-secondary dropdown-toggle" type="button"
                                            id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                                        click to add image
                                    </button>
                                    <form class="dropdown-menu" aria-labelledby="dropdownMenuButton1" method="post"
                                          enctype="multipart/form-data">
                                        {% csrf_token %}
                                        {{ imageform|crispy }}
                                        <input type="submit" value="Upload">
                                    </form>
                                </div>
                                <a href="{% url 'account:p-update' request.user.username %}"
                                   class="link text-center d-block">click
                                    to add image
                                </a>
                            {% endif %}
                        </div>
                        <div class="col-md-9 border border-1">
                            <ul class="list-group my-2">
                                <li class="list-group-item">
                                    <span class="fw-semibold">Name:</span>
                                    {{ user.last_name }} {{ user.first_name }} {{ user.middle_name }}
                                </li>
                                <li class="list-group-item">
                                    <span class="fw-semibold">Username:</span>
                                    {{ user.username }}
                                </li>
                                <li class="list-group-item">
                                    <span class="fw-semibold">Email:</span>
                                    {{ user.email }}
                                </li>
                                <li class="list-group-item">
                                    <span class="fw-semibold">Gender:</span>
                                    {{ user.gender }}
                                </li>
                                <li class="list-group-item">
                                    <span class="fw-semibold">Date of birth:</span>
                                    {{ user.date_of_birth }}
                                </li>
                                <li class="list-group-item">
                                    <span class="fw-semibold">Age:</span>
                                    {{ user.age }}
                                </li>
                                <li class="list-group-item">
                                    <span class="fw-semibold">Father:</span>
                                    {{ user.get_father }}
                                </li>
                                <li class="list-group-item">
                                    <span class="fw-semibold">Mother:</span>
                                    {{ user.get_mother }}
                                </li>
                                <li class="list-group-item">
                                    <span class="fw-semibold">Genealogy:</span>
                                    {% for u in user.genealogy %} |
                                        <a href="{% url 'account:profile' u %}">{{ u }}</a> |
                                    {% endfor %}
                                </li>
                                <li class="list-group-item">
                                    <span class="fw-semibold">Children:</span>
                                    {% for chil in user.children %}
                                        <a href="{% url 'account:dashboard' chil %}">{{ chil }}</a> ,
                                    {% endfor %}
                                </li>
                                <li class="list-group-item"><span
                                        class="fw-semibold">Height(cm):</span> {{ user.height }}</li>
                                <li class="list-group-item"><span
                                        class="fw-semibold">Blood Group:</span> {{ user.blood_group }}</li>
                                <li class="list-group-item"><span
                                        class="fw-semibold">Genotype:</span> {{ user.genotype }}</li>
                                {% if not user.alive %}
                                    <li class="list-group-item">{{ user.date_of_death }}</li>
                                    <li class="list-group-item">{{ user.cause_of_death }}</li>
                                {% endif %}
                                {% if not user %}
                                    <a href="{% url 'account:r_continue' %}">Click Here! to add profile data</a>
                                {% endif %}
                            </ul>

                        </div>
                    </div>
                </div>
                <div class="container">
                    <div class="row">
                        <h3 class="text-center">Biography</h3>
                        <h5 class="text-center fs-6">

                            {% if user.username == request.user.username %}
                                {% if user.biography %}
                                    <a href="{% url 'account:b-update' user.username %}" class="link">edit biography</a>
                                {% else %}
                                    <a href="{% url 'account:b-update' user.username %}" class="">add biography</a>
                                {% endif %}
                            {% endif %}
                        </h5>
                    </div>

                    <div class="row px-md-2">
                        <p class="fw-light lh-lg px-4">{{ user.biography }}</p>
                    </div>
                </div>

                <div>
                    <h4>Additional emails</h4>
                    {% for email in emails %}
                        <ul>
                            <li>{{ email.email }}</li>
                        </ul>
                    {% endfor %}
                    <h4>Phones</h4>
                    {% for number in phone_record %}
                        <ul>
                            <li>{{ number.phone_number }}</li>
                        </ul>
                    {% endfor %}
                </div>

                <div>
                    <h4>Education</h4>
                    <table>
                        <thead>
                        <th>Name of School</th>
                        <th>Duration</th>
                        <th>Year of entrance - year of graduation</th>
                        </thead>
                        <tbody>
                        {% for school in education %}
                            <tr>
                                <td>{{ school.name_of_school }}</td>
                                <td>{{ school.duration }}</td>
                                <td>{{ school.year_of_entrance }} - {{ school.year_of_graduation }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                    <li><a href="{% url 'account:education_list' user.username %}">View all</a></li>
                </div>

                <div>
                    <h4>Hereditary Diseases</h4>
                    <table>
                        <thead>
                        <th>Disease</th>
                        <th>date of infection</th>
                        <th>type</th>
                        </thead>
                        <tbody>
                        {% for disease in diseases %}
                            <tr>
                                <td>{{ disease.disease_name }}</td>
                                <td>{{ disease.date_of_infection }}</td>
                                <td>{{ disease.type }}</td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="col-md-2 visible-md px-0">
                {% include "sidebar.html" %}
            </div>
        </div>
    </div>
    {% include "footer.html" %}
{% endblock %}

